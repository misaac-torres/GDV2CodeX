# GD_v1 · Backend + Frontend

Refactor del notebook original de gestión de dependencias TI a un backend FastAPI
que trabaja directamente con el archivo Excel corporativo y un frontend React
(Vite).

## Configuración de entorno

1. Copia el Excel corporativo en `data/GD_v1.xlsx` o define la ruta real con la
   variable de entorno `GD_EXCEL_PATH`.
2. Opcional: crea un archivo `.env` en la raíz con:
   ```
   GD_EXCEL_PATH=/ruta/al/archivo/GD_v1.xlsx
   ```

## Instalación de dependencias

- **Backend**
  ```bash
  pip install -r backend/requirements.txt
  ```

- **Frontend**
  ```bash
  cd frontend
  npm install
  ```

## Despliegue por entorno

### Desarrollo local

1. Requisitos: Python 3.11+, Node 18+ y un puerto libre 8000 (backend) y 5173 (frontend).
2. Asegura que el Excel esté disponible en `data/GD_v1.xlsx` o define `GD_EXCEL_PATH` apuntando a la ruta corporativa.
3. Desde la raíz del repo ejecuta una de las siguientes opciones:
   ```bash
   make dev
   ```
   Esto levanta FastAPI en `http://localhost:8000` y Vite en `http://localhost:5173` con recarga en caliente.

   O, si prefieres un solo comando sin depender de `make`, usa:
   ```bash
   ./run.sh
   ```
   El script lanza backend y frontend en segundo plano y los detiene cuando presionas `Ctrl+C`.

### Pruebas locales / CI

1. Instala las dependencias de backend y frontend.
2. (Opcional) Exporta `GD_EXCEL_PATH` si necesitas que las pruebas lean un Excel concreto; de lo contrario usarán el archivo de `data/`.
3. Ejecuta toda la batería de tests:
   ```bash
   make test
   ```

### Producción

1. Define `GD_EXCEL_PATH` con la ruta absoluta al Excel corporativo accesible para el servidor.
2. Construye el frontend y arranca el backend sirviendo los estáticos generados:
   ```bash
   make prod
   ```
   Uvicorn expondrá la API y los archivos de `frontend/dist` en `http://0.0.0.0:8000`. Ajusta host/puerto añadiendo flags a `uvicorn` si tu plataforma lo requiere.

## Comandos principales (Makefile)

- Desarrollo (backend + frontend con recarga):
  ```bash
  make dev
  ```

- Pruebas (pytest + vitest):
  ```bash
  make test
  ```

- Producción (build frontend y levantar backend apuntando al Excel real):
  ```bash
  make prod
  ```

## Endpoints principales

- **Proyectos**
  - `GET /projects`
  - `GET /projects/{project_id}`
  - `POST /projects`
  - `PATCH /projects/{project_id}`
- **Métricas**
  - `GET /metrics?scope=all|area|celula&filter=...`
- **Mesas**
  - `GET /boards/experts`
  - `POST /boards/experts/{project_id}/decision`
  - `GET /boards/po-sync`
  - `POST /boards/po-sync/{project_id}/rating`
- **Feedback**
  - `GET /feedback?limit=8`
  - `POST /feedback`

## Estructura

- `backend/`: servicio FastAPI + lógica Excel
- `frontend/`: aplicación React (Vite)
- `data/GD_v1.xlsx`: archivo Excel utilizado por el backend (puede
  apuntar a otra ruta mediante `GD_EXCEL_PATH`).
